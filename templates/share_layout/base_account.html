{% load static %}
{% load i18n %}
{% load compress %}
{% load vite_tags %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex">
    <title>{{ SITE_NAME }} | {% block page_title %}Account{% endblock %}</title>
    <link rel="icon" href="/favicon.ico">

    <!-- Èò≤Èó™ÁÉÅËÑöÊú¨ÔºöÂøÖÈ°ªÂú®CSSÂä†ËΩΩÂâçÁ´ãÂç≥ÊâßË°å -->
    <script>
        (function() {
            const STORAGE_KEY = 'dark-mode-enabled';
            const THEME_ATTR = 'data-theme';
            const ENABLE_SYSTEM = true;

            function getPreferredTheme() {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved !== null) return saved === 'dark' ? 'dark' : 'light';
                if (ENABLE_SYSTEM && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    return 'dark';
                }
                return 'light';
            }

            function applyTheme(theme) {
                if (theme === 'dark') {
                    document.documentElement.setAttribute(THEME_ATTR, 'dark');
                    if (document.body) document.body.setAttribute(THEME_ATTR, 'dark');
                } else {
                    document.documentElement.removeAttribute(THEME_ATTR);
                    if (document.body) document.body.removeAttribute(THEME_ATTR);
                }
            }

            applyTheme(getPreferredTheme());
        })();
    </script>

    <!-- Êñ∞ÂâçÁ´ØÔºöTailwind CSS + Alpine.js + HTMXÔºàÈÄöËøáViteÊûÑÂª∫Ôºâ -->
    {% vite_js 'src/main.js' %}

    <!-- Êèí‰ª∂CSSÊñá‰ª∂ -->
    {% compress css %}
        {% block compress_css %}{% endblock %}
    {% endcompress %}
</head>

<body class="bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-950 min-h-screen flex items-center justify-center p-4" x-data="{ showPassword: false }">
    {% block content %}{% endblock %}

    <!-- Ê∑±Ëâ≤Ê®°ÂºèÂàáÊç¢ÊåâÈíÆÔºà‰∏é‰∏ªÁ´ô‰∏ÄËá¥Ôºâ -->
    <div class="dark-mode-toggle-fixed">
        <button type="button"
                id="dark-mode-toggle-btn"
                class="dark-mode-toggle-btn"
                aria-label="ÂàáÊç¢‰∏ªÈ¢ò"
                title="ÂàáÊç¢ÈªëÂ§úÊ®°Âºè"
                @click="window.DarkMode && window.DarkMode.toggle()">
            <span class="icon-light">‚òÄÔ∏è</span>
            <span class="icon-dark">üåô</span>
        </button>
    </div>
</body>
</html>
